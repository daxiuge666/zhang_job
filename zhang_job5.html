<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åœ¨çº¿è´­ç‰©æŠ˜æ‰£ç½‘ç«™ - å­¦å·6</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: linear-gradient(135deg, #e0f7fa 0%, #f5f5f5 100%);
            color: #333;
        }
        .container {
            background: rgba(255, 255, 255, 0.85);
            backdrop-filter: blur(10px);
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 8px 32px rgba(31, 38, 135, 0.15);
            border: 1px solid rgba(255, 255, 255, 0.5);
        }
        .form-group {
            margin-bottom: 18px;
        }
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #2c3e50;
        }
        input, select {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 8px;
            box-sizing: border-box;
            font-size: 16px;
            background: rgba(255, 255, 255, 0.7);
            transition: border-color 0.3s;
        }
        input:focus, select:focus {
            border-color: #3498db;
            outline: none;
        }
        
        .urgent-checkbox {
            display: flex;
            align-items: center;
        }
        .urgent-checkbox input[type="checkbox"] {
            width: auto;
            margin-right: 10px;
            margin-left: 5px;
        }
        
        button {
            background: linear-gradient(to right, #2c3e50, #3498db);
            color: white;
            padding: 14px 28px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            margin-right: 15px;
            margin-top: 15px;
            transition: transform 0.2s, box-shadow 0.2s;
            box-shadow: 0 4px 15px rgba(52, 152, 219, 0.3);
        }
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(52, 152, 219, 0.4);
        }
        .clock {
            font-size: 24px;
            font-weight: bold;
            color: #2c3e50;
            text-align: center;
            margin-bottom: 25px;
            padding: 15px;
            background: rgba(255, 255, 255, 0.6);
            border-radius: 10px;
            box-shadow: inset 0 0 10px rgba(0, 0, 0, 0.05);
            border: 1px solid rgba(52, 152, 219, 0.2);
        }
        #tips {
            margin-top: 25px;
            padding: 20px;
            background: rgba(236, 240, 241, 0.7);
            border-radius: 10px;
            border-left: 4px solid #3498db;
        }
        #tips p {
            margin: 8px 0;
            font-size: 16px;
        }
        #tips p strong {
            color: #2c3e50;
        }
        #dashboard {
            margin-top: 35px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        th, td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid rgba(0, 0, 0, 0.05);
        }
        th {
            background: linear-gradient(to right, #2c3e50, #3498db);
            color: white;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        tr:nth-child(even) {
            background-color: rgba(236, 240, 241, 0.3);
        }
        tr:hover {
            background-color: rgba(52, 152, 219, 0.1);
        }
        h1 {
            text-align: center;
            margin-bottom: 30px;
            font-size: 2.5em;
            background: linear-gradient(to right, #2c3e50, #3498db);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            font-weight: 700;
        }
        h2 {
            color: #2c3e50;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
            margin-top: 30px;
            margin-bottom: 20px;
        }
        .discount-info {
            background: rgba(236, 240, 241, 0.7);
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 25px;
            border-left: 4px solid #3498db;
        }
        .discount-info ul {
            margin-left: 20px;
            margin-top: 10px;
        }
        .discount-info li {
            margin-bottom: 8px;
            font-size: 16px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>åœ¨çº¿è´­ç‰©æŠ˜æ‰£ç½‘ç«™</h1>
        
        <!-- ç¬¬ä¸€æ–¹é¢ï¼šdocument.write()æé†’æŠ˜æ‰£å’ŒåŠ ä»· -->
        <script>
            document.write('<div class="discount-info">');
            document.write('<h2>ğŸ’¡ å½“å‰ä¼˜æƒ æ´»åŠ¨</h2>');
            document.write('<ul>');
            document.write('<li>ğŸ‰ VIPå®¢æˆ·äº«å— <strong>9æŠ˜</strong> ä¼˜æƒ </li>');
            document.write('<li>âš¡ åŠ æ€¥å‘è´§éœ€é¢å¤–æ”¯ä»˜ <strong>10%</strong> è´¹ç”¨</li>');
            document.write('<li>â° æ¯å°æ—¶å‰10åˆ†é’Ÿå†äº« <strong>8.5æŠ˜</strong> é™æ—¶ä¼˜æƒ ï¼</li>');
            document.write('</ul>');
            document.write('</div>');
        </script>
        
        <!-- ç¬¬äºŒæ–¹é¢ï¼šæ¨¡æ‹Ÿæ—¶é’Ÿ -->
        <div id="clock" class="clock"></div>
        
        <script>
            // åˆ›å»ºæ¨¡æ‹Ÿæ—¶é’Ÿ
            function updateClock() {
                var now = new Date();
                var year = now.getFullYear();
                var month = now.getMonth() + 1;
                var date = now.getDate();
                var day = now.getDay();
                var hour = now.getHours();
                var minute = now.getMinutes();
                var second = now.getSeconds();
                
                var weekDays = ['æ˜ŸæœŸæ—¥', 'æ˜ŸæœŸä¸€', 'æ˜ŸæœŸäºŒ', 'æ˜ŸæœŸä¸‰', 'æ˜ŸæœŸå››', 'æ˜ŸæœŸäº”', 'æ˜ŸæœŸå…­'];
                var timeString = year + 'å¹´' + month + 'æœˆ' + date + 'æ—¥ ' + weekDays[day] + ' ' + 
                               hour + 'æ—¶' + minute + 'åˆ†' + second + 'ç§’';
                
                document.getElementById('clock').innerHTML = timeString;
                
                // æ£€æŸ¥æ˜¯å¦åœ¨æ¯å°æ—¶å‰10åˆ†é’Ÿ
                if(minute >= 0 && minute < 10) {
                    document.getElementById('clock').innerHTML += '<br><span style="color: red;">ğŸ‰ å½“å‰å¤„äºé™æ—¶æŠ˜æ‰£æ—¶æ®µï¼ˆ8.5æŠ˜ï¼‰ï¼</span>';
                } else {
                    document.getElementById('clock').innerHTML += '<br><span style="color: green;">â° é™æ—¶æŠ˜æ‰£ä»…åœ¨æ¯å°æ—¶å‰10åˆ†é’Ÿå¼€æ”¾</span>';
                }
            }
            
            // æ¯ç§’æ›´æ–°ä¸€æ¬¡æ—¶é’Ÿ
            setInterval(updateClock, 1000);
            updateClock(); // ç«‹å³æ‰§è¡Œä¸€æ¬¡
        </script>
        
        <!-- è®¢å•è¡¨å• -->
        <h2>è®¢å•å½•å…¥</h2>
        <form id="orderForm">
            <div class="form-group">
                <label for="customerName">å®¢æˆ·åç§°ï¼š</label>
                <input type="text" id="customerName" name="customerName" required>
            </div>
            
            <div class="form-group">
                <label for="price">å•†å“å•ä»·ï¼ˆå…ƒï¼‰ï¼š</label>
                <input type="number" id="price" name="price" step="0.01" required>
            </div>
            
            <div class="form-group">
                <label for="quantity">è´­ä¹°æ•°é‡ï¼š</label>
                <input type="number" id="quantity" name="quantity" min="1" required>
            </div>
            
            <div class="form-group">
                <label for="isVip">å®¢æˆ·ç±»å‹ï¼š</label>
                <select id="isVip" name="isVip">
                    <option value="false">æ™®é€šå®¢æˆ·</option>
                    <option value="true">VIPå®¢æˆ·</option>
                </select>
            </div>
            
            <div class="form-group urgent-checkbox">
                <input type="checkbox" id="isUrgent" name="isUrgent" value="true">
                <label for="isUrgent">æ˜¯å¦éœ€è¦åŠ æ€¥å‘è´§ï¼ˆ+10%è´¹ç”¨ï¼‰</label>
            </div>
            
            <button type="button" onclick="addOrder()">æ·»åŠ è®¢å•</button>
            <button type="button" onclick="showDashboard()">æŸ¥çœ‹é”€å”®çœ‹æ¿</button>
        </form>
        
        <div id="tips"></div>
        
        <!-- é”€å”®çœ‹æ¿ -->
        <div id="dashboard" style="display: none;">
            <h2>é”€å”®å†å²çœ‹æ¿</h2>
            <div id="dashboardContent"></div>
        </div>
    </div>
    
    <script>
        // å…¨å±€å˜é‡å­˜å‚¨å†å²è®¢å•
        var orderHistory = [];
        
        // ç¬¬ä¸‰æ–¹é¢ï¼šæ•°æ®æ ¡éªŒå‡½æ•°
        function validateData(customerName, price, quantity) {
            // å®¢æˆ·åç§°ä¸èƒ½ä¸ºç©º
            if(customerName === '' || customerName === null) {
                alert('é”™è¯¯ï¼šå®¢æˆ·åç§°ä¸èƒ½ä¸ºç©ºï¼');
                return false;
            }
            
            // å•†å“å•ä»·å¿…é¡»æ˜¯å¤§äº0çš„æ•°å­—
            if(isNaN(price) || price <= 0) {
                alert('é”™è¯¯ï¼šå•†å“å•ä»·å¿…é¡»æ˜¯å¤§äº0çš„æ•°å­—ï¼');
                return false;
            }
            
            // æ•°é‡å¿…é¡»æ˜¯å¤§äº0çš„æ•´æ•°
            if(isNaN(quantity) || quantity <= 0 || !Number.isInteger(Number(quantity))) {
                alert('é”™è¯¯ï¼šè´­ä¹°æ•°é‡å¿…é¡»æ˜¯å¤§äº0çš„æ•´æ•°ï¼');
                return false;
            }
            
            return true;
        }
        
        // ç¬¬å››æ–¹é¢ï¼šè®¡ç®—æŠ˜æ‰£å’ŒåŠ ä»·
        function calculateDiscount(customerName, price, quantity, isVip, isUrgent) {
            // è½¬æ¢æ•°æ®ç±»å‹
            price = parseFloat(price);
            quantity = parseInt(quantity);
            isVip = (isVip === 'true' || isVip === true);
            isUrgent = (isUrgent === 'true' || isUrgent === true);
            
            // éªŒè¯æ•°æ®
            if(!validateData(customerName, price, quantity)) {
                return null;
            }
            
            // è·å–å½“å‰æ—¶é—´
            var now = new Date();
            var minute = now.getMinutes();
            
            // â‘ æ­£å¸¸æ€»ä»·
            var baseTotal = price * quantity;
            
            // â‘¡VIPæŠ˜æ‰£
            var afterVip = isVip ? baseTotal * 0.9 : baseTotal;
            
            // â‘¢åŠ æ€¥è´¹ç”¨
            var afterUrgent = isUrgent ? afterVip * 1.1 : afterVip;
            
            // â‘£æ—¶é—´æŠ˜æ‰£ï¼ˆæ¯å°æ—¶å‰10åˆ†é’Ÿ85æŠ˜ï¼‰
            var hitTimeDiscount = (minute >= 0 && minute < 10);
            var finalTotal = hitTimeDiscount ? afterUrgent * 0.85 : afterUrgent;
            
            // ===== å­¦å·æœ«ä½æ˜¯6çš„ä¸“å±è§„åˆ™ =====
            // æ¡ä»¶ï¼š!isUrgent && quantity >= 2
            // æ•ˆæœï¼šfinalTotal = finalTotal * 0.98
            var rule6Applied = false;
            if(!isUrgent && quantity >= 2) {
                finalTotal = finalTotal * 0.98;
                rule6Applied = true;
            }
            
            // å‡†å¤‡æ˜¾ç¤ºä¿¡æ¯
            var tipsHtml = '<h3>è®¢å•è¯¦æƒ…</h3>';
            tipsHtml += '<p><strong>å®¢æˆ·åç§°ï¼š</strong>' + customerName + '</p>';
            tipsHtml += '<p><strong>å•†å“å•ä»·ï¼š</strong>Â¥' + price.toFixed(2) + '</p>';
            tipsHtml += '<p><strong>è´­ä¹°æ•°é‡ï¼š</strong>' + quantity + ' ä»¶</p>';
            tipsHtml += '<p><strong>å®¢æˆ·ç±»å‹ï¼š</strong>' + (isVip ? 'VIPå®¢æˆ·' : 'æ™®é€šå®¢æˆ·') + '</p>';
            tipsHtml += '<p><strong>åŠ æ€¥å‘è´§ï¼š</strong>' + (isUrgent ? 'æ˜¯' : 'å¦') + '</p>';
            tipsHtml += '<hr>';
            tipsHtml += '<p><strong>åŸºç¡€æ€»ä»·ï¼š</strong>Â¥' + baseTotal.toFixed(2) + '</p>';
            
            if(isVip) {
                tipsHtml += '<p><strong>VIPæŠ˜æ‰£åï¼š</strong>Â¥' + afterVip.toFixed(2) + ' (9æŠ˜)</p>';
            }
            
            if(isUrgent) {
                tipsHtml += '<p><strong>åŠ æ€¥è´¹ç”¨åï¼š</strong>Â¥' + afterUrgent.toFixed(2) + ' (+10%)</p>';
            }
            
            if(hitTimeDiscount) {
                tipsHtml += '<p><strong>é™æ—¶æŠ˜æ‰£åï¼š</strong>Â¥' + finalTotal.toFixed(2) + ' (8.5æŠ˜)</p>';
            }
            
            if(rule6Applied) {
                tipsHtml += '<p><strong>å­¦å·æœ«ä½6ä¼˜æƒ ï¼š</strong>Â¥' + finalTotal.toFixed(2) + ' (æ— åŠ æ€¥ä¸”â‰¥2ä»¶ï¼Œ98æŠ˜)</p>';
            }
            
            tipsHtml += '<hr>';
            tipsHtml += '<p style="color: red; font-size: 18px;"><strong>æœ€ç»ˆåº”ä»˜é‡‘é¢ï¼šÂ¥' + finalTotal.toFixed(2) + '</strong></p>';
            
            // æ˜¾ç¤ºç»“æœ
            document.getElementById('tips').innerHTML = tipsHtml;
            
            // åˆ›å»ºè®¢å•å¯¹è±¡å¹¶å­˜å…¥æ•°ç»„
            var order = {
                customerName: customerName,
                price: price,
                quantity: quantity,
                isVip: isVip,
                isUrgent: isUrgent,
                baseTotal: baseTotal,
                finalTotal: finalTotal,
                orderTime: new Date().toLocaleString()
            };
            
            orderHistory.push(order);
            
            // ä½¿ç”¨push()æ–¹æ³•æ˜¾ç¤ºåœ¨æ•°ç»„ä¸­
            var orderArray = [];
            orderArray.push('è®¢å•æ•°é‡ï¼š' + orderHistory.length + ' ç¬”');
            orderArray.push('å½“å‰è®¢å•ï¼š' + customerName + ' - Â¥' + finalTotal.toFixed(2));
            
            console.log('è®¢å•æ•°ç»„å†…å®¹ï¼š', orderArray);
            
            return order;
        }
        
        // æ·»åŠ è®¢å•å‡½æ•°
        function addOrder() {
            // è·å–è¡¨å•æ•°æ®
            var customerName = document.getElementById('customerName').value;
            var price = document.getElementById('price').value;
            var quantity = document.getElementById('quantity').value;
            var isVip = document.getElementById('isVip').value;
            var isUrgent = document.getElementById('isUrgent').checked;
            
            // è®¡ç®—æŠ˜æ‰£
            calculateDiscount(customerName, price, quantity, isVip, isUrgent);
            
            // æ¸…ç©ºè¡¨å•ï¼ˆä¿ç•™éƒ¨åˆ†å­—æ®µï¼‰
            document.getElementById('orderForm').reset();
        }
        
        // ç¬¬äº”æ–¹é¢ï¼šæ˜¾ç¤ºé”€å”®çœ‹æ¿
        function showDashboard() {
            var dashboard = document.getElementById('dashboard');
            var content = document.getElementById('dashboardContent');
            
            if(orderHistory.length === 0) {
                content.innerHTML = '<p style="color: red;">æš‚æ— è®¢å•æ•°æ®</p>';
            } else {
                // è®¡ç®—ç»Ÿè®¡æ•°æ®
                var totalAmount = 0;
                var totalQuantity = 0;
                var vipCount = 0;
                var urgentCount = 0;
                
                for(var i = 0; i < orderHistory.length; i++) {
                    totalAmount += orderHistory[i].finalTotal;
                    totalQuantity += orderHistory[i].quantity;
                    if(orderHistory[i].isVip) vipCount++;
                    if(orderHistory[i].isUrgent) urgentCount++;
                }
                
                // æ˜¾ç¤ºç»Ÿè®¡ä¿¡æ¯
                var html = '<div style="margin-bottom: 20px; padding: 10px; background: #e8f4f8; border-radius: 5px;">';
                html += '<h3>é”€å”®ç»Ÿè®¡</h3>';
                html += '<p><strong>æ€»è®¢å•æ•°ï¼š</strong>' + orderHistory.length + ' ç¬”</p>';
                html += '<p><strong>æ€»é”€å”®é¢ï¼š</strong>Â¥' + totalAmount.toFixed(2) + '</p>';
                html += '<p><strong>æ€»é”€å”®é‡ï¼š</strong>' + totalQuantity + ' ä»¶</p>';
                html += '<p><strong>VIPå®¢æˆ·æ•°ï¼š</strong>' + vipCount + ' äºº</p>';
                html += '<p><strong>åŠ æ€¥è®¢å•æ•°ï¼š</strong>' + urgentCount + ' ç¬”</p>';
                html += '</div>';
                
                // æ˜¾ç¤ºè®¢å•è¡¨æ ¼
                html += '<table>';
                html += '<tr><th>è®¢å•æ—¶é—´</th><th>å®¢æˆ·åç§°</th><th>å•ä»·</th><th>æ•°é‡</th><th>VIP</th><th>åŠ æ€¥</th><th>åŸä»·</th><th>å®ä»˜</th></tr>';
                
                for(var i = 0; i < orderHistory.length; i++) {
                    var order = orderHistory[i];
                    html += '<tr>';
                    html += '<td>' + order.orderTime + '</td>';
                    html += '<td>' + order.customerName + '</td>';
                    html += '<td>Â¥' + order.price.toFixed(2) + '</td>';
                    html += '<td>' + order.quantity + '</td>';
                    html += '<td>' + (order.isVip ? 'æ˜¯' : 'å¦') + '</td>';
                    html += '<td>' + (order.isUrgent ? 'æ˜¯' : 'å¦') + '</td>';
                    html += '<td>Â¥' + order.baseTotal.toFixed(2) + '</td>';
                    html += '<td>Â¥' + order.finalTotal.toFixed(2) + '</td>';
                    html += '</tr>';
                }
                
                html += '</table>';
                content.innerHTML = html;
            }
            
            dashboard.style.display = 'block';
        }
    </script>
</body>
</html>